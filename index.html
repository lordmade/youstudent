<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome to TutorApp</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    /* Animation for the learning icon */
    @keyframes bookPulse {
      0%, 100% { transform: scale(1) rotate(0deg); }
      50% { transform: scale(1.1) rotate(5deg); }
    }
    @keyframes fadeIn {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }
    .animate-book {
      animation: bookPulse 2s ease-in-out infinite;
    }
    .animate-fade-in {
      animation: fadeIn 1s ease-in forwards;
    }
  </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
  <div class="bg-white p-8 rounded-lg shadow-lg text-center animate-fade-in">
    <!-- Learning Icon SVG (Book with Graduation Cap) -->
    <svg class="w-24 h-24 mx-auto animate-book" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" stroke="#2563EB"/>
      <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" stroke="#2563EB"/>
      <path d="M12 8l-8 4 8 4 8-4-8-4z" fill="#10B981"/>
      <path d="M12 16v6" stroke="#10B981"/>
      <path d="M8 18h8" stroke="#10B981"/>
    </svg>
    <h1 class="text-2xl font-bold text-gray-800 mt-4">Welcome to TutorApp</h1>
    <p class="text-gray-600 mt-2">Empowering Learning, Connecting Tutors</p>
    <div class="mt-4">
      <svg class="animate-spin h-5 w-5 mx-auto text-blue-600" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
      </svg>
    </div>
    <p id="error" class="text-red-500 text-sm mt-2 hidden"></p>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBOyZ3As4GTuNvjemvPF_SpsC6m6vqtNhc",
      authDomain: "fire-b-a8878.firebaseapp.com",
      databaseURL: "https://fire-b-a8878-default-rtdb.firebaseio.com",
      projectId: "fire-b-a8878",
      storageBucket: "fire-b-a8878.firebasestorage.app",
      messagingSenderId: "658673187627",
      appId: "1:658673187627:web:32699cbc33e85f4bafa36e",
      measurementId: "G-2505EVBRWX"
    };

    // Initialize Firebase with error handling
    let auth;
    try {
      firebase.initializeApp(firebaseConfig);
      auth = firebase.auth();
      console.log('Firebase initialized successfully');
    } catch (error) {
      console.error('Firebase initialization failed:', error);
      document.getElementById('error').textContent = 'Failed to connect to server. Redirecting...';
      document.getElementById('error').classList.remove('hidden');
      // Fallback redirect to login.html after 5 seconds
      setTimeout(() => {
        window.location.href = 'login.html';
      }, 5000);
    }

    // Redirect logic
    if (auth) {
      auth.onAuthStateChanged((user) => {
        console.log('Auth state checked:', user ? 'User logged in' : 'No user');
        if (user) {
          // Redirect to dashboard if logged in
          window.location.href = 'dashboard.html';
        } else {
          // Redirect to login after 5 seconds if not logged in
          setTimeout(() => {
            window.location.href = 'login.html';
          }, 5000);
        }
      }, (error) => {
        console.error('Auth state error:', error);
        document.getElementById('error').textContent = 'Auth error. Redirecting...';
        document.getElementById('error').classList.remove('hidden');
        // Fallback redirect
        setTimeout(() => {
          window.location.href = 'login.html';
        }, 5000);
      });
    } else {
      // Fallback if auth initialization failed
      console.warn('Auth not initialized. Redirecting to login...');
      setTimeout(() => {
        window.location.href = 'login.html';
      }, 5000);
    }
  </script>
</body>
</html>
